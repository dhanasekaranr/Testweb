// ========== STATE: lookup.selectors.ts ==========
import { createFeatureSelector, createSelector } from '@ngrx/store';
import { LookupState } from './lookup.reducer';

export const selectLookupState = createFeatureSelector<LookupState>('lookup');
export const selectLookupEntities = createSelector(
  selectLookupState,
  state => state.entities
);

// selector now takes optional params to filter additionalData
export const selectLookupByName = (lookupName: string, params?: Record<string, any>) => createSelector(
  selectLookupEntities,
  entities => {
    const items = entities[lookupName] || [];
    if (!params) return items;
    return items.filter(item =>
      params && item.additionalData && Object.keys(params).every(
        k => item.additionalData![k] === params[k]
      )
    );
  }
);

export const selectLoading = createSelector(
  selectLookupState,
  state => state.loading
);
export const selectError = createSelector(
  selectLookupState,
  state => state.error
);
