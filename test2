/**
 * Popover Component Styles
 * 
 * Centralized styles for the popover system including:
 * - Base panel styles
 * - Arrow positioning for all placements
 * - Material Design 3 theming integration
 * - WCAG 2.2 AAA compliant utilities
 * - CSS-based animations (no JavaScript delays)
 */

/* ========================================
   Popover Panel Base
   ======================================== */

.shared-popover-panel {
  position: relative;
  z-index: 1010;
}

/* ========================================
   Arrow Base Styles
   ======================================== */

.shared-popover-panel .arrow {
  position: absolute;
  width: var(--arrow-size, 10px);
  height: var(--arrow-size, 10px);
}

/* ========================================
   Arrow Positioning - Top Placements
   ======================================== */

.shared-popover-panel--top .arrow {
  bottom: -7px;
  left: 50%;
  transform: translateX(-50%) rotate(45deg);
}

.shared-popover-panel--top-start .arrow {
  bottom: -7px;
  left: 20px;
  transform: rotate(45deg);
}

.shared-popover-panel--top-end .arrow {
  bottom: -7px;
  right: 20px;
  transform: rotate(45deg);
}

/* Dynamic arrow positioning for top placements with inline styles */
.shared-popover-panel--top .arrow[style*='left'],
.shared-popover-panel--top-start .arrow[style*='left'],
.shared-popover-panel--top-end .arrow[style*='left'] {
  transform: translateX(-50%) rotate(45deg);
}

/* ========================================
   Arrow Positioning - Bottom Placements
   ======================================== */

.shared-popover-panel--bottom .arrow {
  top: -7px;
  left: 50%;
  transform: translateX(-50%) rotate(45deg);
}

.shared-popover-panel--bottom-start .arrow {
  top: -7px;
  left: 20px;
  transform: rotate(45deg);
}

.shared-popover-panel--bottom-end .arrow {
  top: -7px;
  right: 20px;
  transform: rotate(45deg);
}

/* Dynamic arrow positioning for bottom placements with inline styles */
.shared-popover-panel--bottom .arrow[style*='left'],
.shared-popover-panel--bottom-start .arrow[style*='left'],
.shared-popover-panel--bottom-end .arrow[style*='left'] {
  transform: translateX(-50%) rotate(45deg);
}

/* ========================================
   Arrow Positioning - Left Placements
   ======================================== */

.shared-popover-panel--left .arrow {
  right: -5px;
  top: 50%;
  transform: translateY(-50%) rotate(-45deg);
}

.shared-popover-panel--left-start .arrow {
  right: -7px;
  top: 20px;
  transform: rotate(45deg);
}

.shared-popover-panel--left-end .arrow {
  right: -7px;
  bottom: 20px;
  transform: rotate(45deg);
}

/* Dynamic arrow positioning for left placements with inline styles */
.shared-popover-panel--left .arrow[style*='top'] {
  transform: translateY(-50%) rotate(-45deg);
}

/* ========================================
   Arrow Positioning - Right Placements
   ======================================== */

.shared-popover-panel--right .arrow {
  left: -5px;
  top: 50%;
  transform: translateY(-50%) rotate(135deg);
}

.shared-popover-panel--right-start .arrow {
  left: -7px;
  top: 20px;
  transform: rotate(45deg);
}

.shared-popover-panel--right-end .arrow {
  left: -7px;
  bottom: 20px;
  transform: rotate(45deg);
}

/* Dynamic arrow positioning for right placements with inline styles */
.shared-popover-panel--right .arrow[style*='top'] {
  transform: translateY(-50%) rotate(135deg);
}

/* ========================================
   Material Design 3 Theming
   ======================================== */

:root {
  --popover-bg: var(--md-sys-color-surface-container-high, #2a2d35);
  --popover-fg: var(--md-sys-color-on-surface, #e1e5eb);
}

/* ========================================
   Popover Trigger Button Styles
   Reusable help button styles for popover triggers
   ======================================== */

/**
 * Standard help button for popover triggers
 * Use with: <button class="shared-popover-help-button">
 */
.shared-popover-help-button {
  margin-left: 4px !important;
  width: 20px !important;
  height: 20px !important;
  line-height: 20px !important;
  
  .shared-popover-help-icon {
    font-size: 16px !important;
    width: 16px !important;
    height: 16px !important;
    color: var(--md-sys-color-on-surface-variant, #49454f) !important;
    opacity: 0.7;
    transition: color 0.2s ease, opacity 0.2s ease;
  }
  
  &:hover .shared-popover-help-icon {
    color: var(--md-sys-color-primary, #6750a4) !important;
    opacity: 1;
  }
}

/**
 * Search field help button
 * Use with: <button class="shared-popover-search-help-button">
 */
.shared-popover-search-help-button {
  width: 24px !important;
  height: 24px !important;
  padding: 0 !important;
  flex-shrink: 0;
  
  .shared-popover-help-icon {
    font-size: 18px !important;
    width: 18px !important;
    height: 18px !important;
    color: var(--md-sys-color-on-surface-variant, #49454f) !important;
    opacity: 0.6;
    transition: color 0.2s ease, opacity 0.2s ease;
  }
  
  &:hover .shared-popover-help-icon {
    color: var(--md-sys-color-primary, #6750a4) !important;
    opacity: 1;
  }
}

/**
 * Page title help button (larger, more prominent)
 * Use with: <button class="shared-popover-page-help-button">
 */
.shared-popover-page-help-button {
  width: 28px !important;
  height: 28px !important;
  padding: 0 !important;
  flex-shrink: 0;
  
  .shared-popover-help-icon {
    font-size: 20px !important;
    width: 20px !important;
    height: 20px !important;
    color: var(--md-sys-color-primary, #6750a4) !important;
    opacity: 0.8;
    transition: opacity 0.2s ease;
  }
  
  &:hover .shared-popover-help-icon {
    opacity: 1;
  }
}

/**
 * Search bar container with help button
 * Use with: <div class="shared-popover-search-container">
 */
.shared-popover-search-container {
  display: flex;
  align-items: center;
  gap: 4px;
  width: 100%;
  
  .search-field {
    flex: 1;
  }
  
  mat-form-field {
    flex: 1;
  }
}

/**
 * Page title with help button container
 * Use with: <div class="shared-popover-title-container">
 */
.shared-popover-title-container {
  display: flex;
  align-items: center;
  gap: 4px;
  
  .page-title {
    margin: 0;
    line-height: 1;
  }
  
  h1 {
    margin: 0;
    line-height: 1;
  }
}

/**
 * Header cell with help button layout
 * Automatically applied to table headers with help buttons
 */
.mat-mdc-header-cell {
  &:has(.shared-popover-help-button) {
    display: flex !important;
    align-items: center !important;
    gap: 4px !important;
    
    .shared-popover-help-button {
      flex-shrink: 0;
    }
  }
}

/* ========================================
   WCAG 2.2 AAA Accessibility Utilities
   ======================================== */

/**
 * Screen Reader Only Content
 * Hides content visually while keeping it accessible to screen readers
 */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/**
 * Live Region for Announcements
 * Used for dynamic content that should be announced to screen readers
 */
.sr-live-region {
  position: absolute !important;
  left: -10000px !important;
  width: 1px !important;
  height: 1px !important;
  overflow: hidden !important;
}
