<!-- EXPAND COLUMN -->
<ng-container matColumnDef="expand" *ngIf="tableConfig?.enableRowExpand">
  <th mat-header-cell *matHeaderCellDef class="col-expand"></th>

  <td mat-cell *matCellDef="let row" class="col-expand">
    <!-- show + icon only if this row has detail -->
    <button
      mat-icon-button
      *ngIf="hasDetail(row); else noExpand"
      (click)="toggleExpand(row); $event.stopPropagation()"
      [attr.aria-label]="isExpanded(row) ? 'Collapse details' : 'Expand details'">

      <mat-icon>{{ isExpanded(row) ? 'remove' : 'add' }}</mat-icon>
    </button>

    <ng-template #noExpand>
      <!-- keep spacing aligned when no detail -->
      <span class="no-expand"></span>
    </ng-template>
  </td>
</ng-container>
2) app-table-list.component.ts — add hasDetail()
ts
Copy code
hasDetail(row: any): boolean {
  return !!row?.detail; // your data uses row.detail
}
3) Make sure table supports detail rows
Your table tag must include:

html
Copy code
<table mat-table [dataSource]="dataSource" multiTemplateDataRows>
4) Detail row block (unchanged, but only renders when expanded)
html
Copy code
<ng-container matColumnDef="detail">
  <td mat-cell *matCellDef="let row" [attr.colspan]="displayedColumns.length" class="detail-cell">
    <div class="detail-wrap" *ngIf="isExpanded(row)">
      <ng-container
        *ngIf="detailTemplate"
        [ngTemplateOutlet]="detailTemplate"
        [ngTemplateOutletContext]="{ $implicit: row }">
      </ng-container>
    </div>
  </td>
</ng-container>

<tr mat-row *matRowDef="let row; columns: ['detail']" class="detail-row"></tr>
5) SCSS for alignment
scss
Copy code
.col-expand {
  width: 44px;
  white-space: nowrap;
}

.no-expand {
  display: inline-block;
  width: 40px; // keeps column width consistent
}
Important
Your displayedColumns must include 'expand' at the beginning when enableRowExpand is true.

This will show + for rows with detail, and clicking opens the detail row. Clicking again shows − and collapses.

If you want the entire row click to also expand (in addition to the + icon), tell me — it’s a one-line change, but for performance/UX I usually keep it icon-only.







You said:
on the usage component, what changes needed ?


ChatGPT said:
Very little. In the usage (parent) component you only need to:

Turn on expand in masterConfig

Pass the detailTemplate

(Optional) Add expandedChange if you want lazy-load, but for row.detail you don’t need it.

1) Parent TS changes
Your data (same)
ts
Copy code
masterRows = [
  {
    id: '1',
    name: 'John',
    status: 'Open',
    detail: { lastupdatedBy: 'kelly', lastUpdatedTime: '1/1/2025 10:00 AM' }
  },
  { id: '2', name: 'Mary', status: 'Closed' },
  {
    id: '3',
    name: 'Jane',
    status: 'Open',
    detail: { lastupdatedBy: 'kale', lastUpdatedTime: '1/1/2025 12:00 AM' }
  }
];
Master table config (add enableRowExpand: true)
ts
Copy code
masterConfig: TableConfig = {
  enableRowExpand: true,     // ✅ required for + icon column
  enableSorting: true,
  enableFiltering: true,
  enablePagination: false,

  columns: [
    { columnDef: 'id', header: 'ID', cell: (r: any) => String(r.id), sortable: true, filterable: true },
    { columnDef: 'name', header: 'Name', cell: (r: any) => r.name, sortable: true, filterable: true },
    { columnDef: 'status', header: 'Status', cell: (r: any) => r.status, sortable: true, filterable: true }
  ],

  actions: { edit: true, delete: true }
};
That’s it on TS.

2) Parent HTML changes
Pass detailTemplate:

html
Copy code
<app-table-list
  [dataList]="masterRows"
  [tableConfig]="masterConfig"
  [detailTemplate]="detailTpl">
</app-table-list>

<ng-template #detailTpl let-row>
  <div *ngIf="row.detail; else noDetail" class="detail-panel">
    <div><b>Last Updated By:</b> {{ row.detail.lastupdatedBy }}</div>
    <div><b>Last Updated Time:</b> {{ row.detail.lastUpdatedTime }}</div>
  </div>

  <ng-template #noDetail>
    <div class="detail-panel muted">No detail available.</div>
  </ng-template>
</ng-template>
3) Optional: if you want to lazy-load details
Only then you add:

html
Copy code
<app-table-list
  ...
  (expandedChange)="onExpanded($event)">
</app-table-list>
ts
Copy code
onExpanded(row: any | null) {
  if (!row) return;
  // fetch details by row.id and assign row.detail or cache[row.id]
}
