const API_PREFIX = '/api/v1.0';

function esc(s: string) {
  return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

function normPath(path: string) {
  return path.startsWith('/') ? path.slice(1) : path;
}

// GET: allow optional trailing slash + optional querystring
export function apiGet(path: string): RegExp {
  const p = esc(normPath(path));
  return new RegExp(`${esc(API_PREFIX)}/+${p}/?(\\?.*)?$`, 'i');
}

// POST: allow optional trailing slash (no query expected, but harmless if added)
export function apiPost(path: string): RegExp {
  const p = esc(normPath(path));
  return new RegExp(`${esc(API_PREFIX)}/+${p}/?$`, 'i');
}
