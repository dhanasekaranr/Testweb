// store-factory.ts
import { signalStore, withState, type SignalStoreFeature } from '@ngrx/signals';

// A constructor-like type Angular DI will accept
export type StoreToken<Api> = abstract new (...args: never[]) => Api;

export function createSignalFeatureStore<State extends object>(
  name: string,
  initial: State,
  ...features: SignalStoreFeature[]
): StoreToken<State & { [key: string]: any }> {
  const token = signalStore(
    { providedIn: 'root' },
    withState(initial),
    ...features
  );

  // Cast so Angular sees this as a DI token
  return token as StoreToken<State & { [key: string]: any }>;
}
